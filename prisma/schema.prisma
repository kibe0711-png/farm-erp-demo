generator client {
  provider        = "prisma-client-js"
  previewFeatures = ["driverAdapters"]
}

datasource db {
  provider = "postgresql"
}

model Farm {
  id              Int         @id @default(autoincrement())
  name            String      @unique @db.VarChar(100)
  laborRatePerDay Decimal?    @map("labor_rate_per_day") @db.Decimal(10, 2)
  createdAt       DateTime    @default(now()) @map("created_at")
  phases          FarmPhase[]

  @@map("farms")
}

model FarmPhase {
  id         Int      @id @default(autoincrement())
  cropCode   String   @map("crop_code") @db.VarChar(50)
  phaseId    String   @map("phase_id") @db.VarChar(50)
  sowingDate DateTime @map("sowing_date") @db.Date
  farm       String   @db.VarChar(100)
  farmId     Int?     @map("farm_id")
  farmRef    Farm?    @relation(fields: [farmId], references: [id])
  areaHa     Decimal  @default(0) @map("area_ha") @db.Decimal(10, 4)
  createdAt  DateTime @default(now()) @map("created_at")

  @@map("farm_phases")
}

model LaborSop {
  id               Int      @id @default(autoincrement())
  cropCode         String   @map("crop_code") @db.Text
  week             Int
  task             String   @db.Text
  noOfCasuals      Int      @map("no_of_casuals")
  costPerCasualDay Decimal  @map("cost_per_casual_day") @db.Decimal(10, 2)
  noOfDays         Int      @map("no_of_days")
  createdAt        DateTime @default(now()) @map("created_at")

  @@map("labor_sop")
}

model NutriSop {
  id               Int      @id @default(autoincrement())
  cropCode         String   @map("crop_code") @db.Text
  week             Int
  products         String   @db.Text
  activeIngredient String   @map("active_ingredient") @db.Text
  rateLitre        Decimal  @map("rate_litre") @db.Decimal(10, 4)
  rateHa           Decimal  @map("rate_ha") @db.Decimal(10, 4)
  unitPriceRwf     Decimal  @map("unit_price_rwf") @db.Decimal(12, 2)
  cost             Decimal  @db.Decimal(12, 2)
  createdAt        DateTime @default(now()) @map("created_at")

  @@map("nutri_sop")
}

model FeedingRecord {
  id              Int      @id @default(autoincrement())
  farmPhaseId     Int      @map("farm_phase_id")
  applicationDate DateTime @map("application_date") @db.Date
  product         String   @db.Text
  actualRateHa    Decimal  @map("actual_rate_ha") @db.Decimal(10, 4)
  actualQty       Decimal  @map("actual_qty") @db.Decimal(10, 4)
  notes           String?  @db.Text
  createdAt       DateTime @default(now()) @map("created_at")

  @@map("feeding_records")
}

model LaborSchedule {
  id            Int      @id @default(autoincrement())
  farmPhaseId   Int      @map("farm_phase_id")
  laborSopId    Int      @map("labor_sop_id")
  weekStartDate DateTime @map("week_start_date") @db.Date
  dayOfWeek     Int      @map("day_of_week")
  createdAt     DateTime @default(now()) @map("created_at")

  @@unique([farmPhaseId, laborSopId, weekStartDate, dayOfWeek])
  @@map("labor_schedules")
}

model User {
  id        Int      @id @default(autoincrement())
  email     String   @unique @db.VarChar(255)
  name      String   @db.VarChar(100)
  password  String   @db.Text
  createdAt DateTime @default(now()) @map("created_at")

  @@map("users")
}
